---
title: "hw"
author: "Bassia Huo"
date: "11/7/2018"
output: html_document
---

# load library

```
library("readxl")
library(glmnet)
```

# read data

read data from 'Store3.xlsx', and choose number "1" as target

```
data <- read_excel("./Store3.xlsx")

train <- data[data[, "Random"] == "Train",]
test <- data[data[, "Random"] == "Test",]

train_x = as.matrix(train[, c("F1", "D1", "PR1", "P1")])
train_y = as.matrix(train[, c("Y1")])

test_x = as.matrix(test[, c("F1", "D1", "PR1", "P1")])
test_y = as.matrix(test[, c("Y1")])
```

# ridge

MSE is 218283

```
set.seed(42)
grid = 10^seq(10,-2,length=100)

ridge.mod = cv.glmnet(train_x, train_y, alpha=0, lambda=grid)
bestlam.ridge = ridge.mod$lambda.min
test.predicted.ridge <- predict(ridge.mod, s=bestlam.ridge, newx=test_x)
mean((test.predicted.ridge - test_y) ^ 2)
coef(ridge.mod)
```

# lasso

MSE is 212545.5

```
set.seed(42)
grid = 10^seq(10,-2,length=100)

lasso.mod = cv.glmnet(train_x, train_y, alpha=1, lambda=grid)
bestlam.lasso = lasso.mod$lambda.min
test.predicted.lasso <- predict(lasso.mod, s=bestlam.lasso, newx=test_x)
mean((test.predicted.lasso - test_y) ^ 2)
coef(lasso.mod)
```

